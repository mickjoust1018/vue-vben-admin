var k=Object.defineProperty,v=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var h=(o,t,e)=>t in o?k(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,u=(o,t)=>{for(var e in t||(t={}))S.call(t,e)&&h(o,e,t[e]);if(g)for(var e of g(t))A.call(t,e)&&h(o,e,t[e]);return o},b=(o,t)=>v(o,B(t));var f=(o,t,e)=>new Promise((s,r)=>{var d=a=>{try{l(e.next(a))}catch(c){r(c)}},i=a=>{try{l(e.throw(a))}catch(c){r(c)}},l=a=>a.done?s(a.value):Promise.resolve(a.value).then(d,i);l((e=e.apply(o,t)).next())});import{B as y,a as x}from"./index-36d5da49.js";import{B as q}from"./BasicForm-adcd46e9.js";import"./componentMap-95d9f68b.js";import{u as C}from"./useForm-552b1b9b.js";import"./RadioButtonGroup-790e54c8.js";import{i as T,b as $,a as L}from"./system-cec1b8f5.js";import{d as O,k as w,e as R,u as p,a7 as _,_ as N,a8 as U,a9 as V,f as j,ac as D}from"./vue-bfa52d01.js";import{_ as z}from"./index-59f8fabe.js";const ae=[{title:"用户名",dataIndex:"account",width:120},{title:"昵称",dataIndex:"nickname",width:120},{title:"邮箱",dataIndex:"email",width:120},{title:"创建时间",dataIndex:"createTime",width:180},{title:"角色",dataIndex:"role",width:200},{title:"备注",dataIndex:"remark"}],ne=[{field:"account",label:"用户名",component:"Input",colProps:{span:8}},{field:"nickname",label:"昵称",component:"Input",colProps:{span:8}}],E=[{field:"account",label:"用户名",component:"Input",helpMessage:["本字段演示异步验证","不能输入带有admin的用户名"],rules:[{required:!0,message:"请输入用户名"},{validator(o,t){return new Promise((e,s)=>{T(t).then(()=>e()).catch(r=>{s(r.message||"验证失败")})})}}]},{field:"pwd",label:"密码",component:"InputPassword",required:!0,ifShow:!1},{label:"角色",field:"role",component:"ApiSelect",componentProps:{api:$,labelField:"roleName",valueField:"roleValue"},required:!0},{field:"dept",label:"所属部门",component:"TreeSelect",componentProps:{fieldNames:{label:"deptName",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"nickname",label:"昵称",component:"Input",required:!0},{label:"邮箱",field:"email",component:"Input",required:!0},{label:"备注",field:"remark",component:"InputTextArea"}],G=O({name:"AccountModal",components:{BasicModal:y,BasicForm:q},emits:["success","register"],setup(o,{emit:t}){const e=w(!0),s=w(""),[r,{setFieldsValue:d,updateSchema:i,resetFields:l,validate:a}]=C({labelWidth:100,baseColProps:{span:24},schemas:E,showActionButtonGroup:!1,actionColOptions:{span:23}}),[c,{setModalProps:m,closeModal:I}]=x(n=>f(this,null,function*(){l(),m({confirmLoading:!1}),e.value=!!(n!=null&&n.isUpdate),p(e)&&(s.value=n.record.id,d(u({},n.record)));const P=yield L();i([{field:"pwd",show:!p(e)},{field:"dept",componentProps:{treeData:P}}])})),M=R(()=>p(e)?"编辑账号":"新增账号");function F(){return f(this,null,function*(){try{const n=yield a();m({confirmLoading:!0}),console.log(n),I(),t("success",{isUpdate:p(e),values:b(u({},n),{id:s.value})})}finally{m({confirmLoading:!1})}})}return{registerModal:c,registerForm:r,getTitle:M,handleSubmit:F}}});function W(o,t,e,s,r,d){const i=_("BasicForm"),l=_("BasicModal");return N(),U(l,D(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:V(()=>[j(i,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const H=z(G,[["render",W]]),se=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{H as A,se as a,ae as c,ne as s};
